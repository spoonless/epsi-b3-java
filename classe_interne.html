
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Les classes internes &#8212; documentation Le langage Java 1.0</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Les annotations" href="les_annotations.html" />
    <link rel="prev" title="Streams" href="streams.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="les-classes-internes">
<h1>Les classes internes<a class="headerlink" href="#les-classes-internes" title="Lien permanent vers ce titre">¶</a></h1>
<p>La plupart du temps, une classe en Java est déclarée dans un fichier
portant le même nom que la classe avec l’extension <em>.java</em>. Cependant, il est également
possible de déclarer des classes dans une classe. On parle alors de classes
internes (<em>inner classes</em>). Cela est également possible, dans une certaine limite,
pour les interfaces et les énumérations.</p>
<p>La déclaration des classes internes peut se faire dans l’ordre que l’on souhaite
à l’intérieur du bloc de déclaration de la classe englobante. Les classes internes
peuvent être ou non déclarées <strong>static</strong>. Ces deux cas correspondent à deux
usages particuliers des classes internes.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClasseEnglobante</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ClasseInterneStatic</span> <span class="o">{</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClasseInterne</span> <span class="o">{</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="les-classes-internes-static">
<h2>Les classes internes static<a class="headerlink" href="#les-classes-internes-static" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les classes internes déclarées <strong>static</strong> sont des classes pour lesquelles
l’espace de noms est celui de la classe englobante.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClasseEnglobante</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ClasseInterne</span> <span class="o">{</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<p>Pour une classe interne <strong>static</strong> :</p>
<ul>
<li><p class="first">Son nom complet inclus le nom de la classe englobante (qui agit comme un package).
Pour la classe ci-dessus, le nom complet de <em>ClasseInterne</em> est :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">fr.epsi.b3</span><span class="o">.</span><span class="na">ClasseEnglobante</span><span class="o">.</span><span class="na">ClasseInterne</span>
</pre></div>
</div>
</li>
<li><p class="first">La classe englobante et la classe interne partage le même espace privé. Cela
signifie que les attributs et les méthodes privés déclarés dans la classe
englobante sont accessibles à la classe interne. Réciproquement, la classe
englobante peut avoir accés aux éléments privés de la classe interne.</p>
</li>
<li><p class="first">Une instance de la classe interne n’a accès directement qu’aux
attributs et aux méthodes de la classe englobante qui sont déclarés
<strong>static</strong>.</p>
</li>
</ul>
<p>Une classe interne <strong>static</strong> est souvent utilisée pour éviter de séparer
dans des fichiers différents de petites classes utilitaires et ainsi de faciliter
la lecture du code. Dans l’exemple ci-dessous, plutôt que de créer un fichier
spécifique pour l’implémentation d’un comparateur, on ajoute son implémentation
comme une classe interne.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Comparator</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Individu</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Comparateur</span> <span class="kd">implements</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Individu</span> <span class="n">i1</span><span class="o">,</span> <span class="n">Individu</span> <span class="n">i2</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">i1</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">i2</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="kt">int</span> <span class="n">cmp</span> <span class="o">=</span> <span class="n">i1</span><span class="o">.</span><span class="na">nom</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">i2</span><span class="o">.</span><span class="na">nom</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">cmp</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">cmp</span> <span class="o">=</span> <span class="n">i1</span><span class="o">.</span><span class="na">prenom</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">i2</span><span class="o">.</span><span class="na">prenom</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="k">return</span> <span class="n">cmp</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">prenom</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">nom</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Individu</span><span class="o">(</span><span class="n">String</span> <span class="n">prenom</span><span class="o">,</span> <span class="n">String</span> <span class="n">nom</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">prenom</span> <span class="o">=</span> <span class="n">prenom</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">nom</span> <span class="o">=</span> <span class="n">nom</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">prenom</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">nom</span><span class="o">;</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Individu</span><span class="o">[]</span> <span class="n">individus</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">new</span> <span class="n">Individu</span><span class="o">(</span><span class="s">&quot;John&quot;</span><span class="o">,</span> <span class="s">&quot;Eod&quot;</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">Individu</span><span class="o">(</span><span class="s">&quot;Annabel&quot;</span><span class="o">,</span> <span class="s">&quot;Doe&quot;</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">Individu</span><span class="o">(</span><span class="s">&quot;John&quot;</span><span class="o">,</span> <span class="s">&quot;Doe&quot;</span><span class="o">)</span>
<span class="o">};</span>

<span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">individus</span><span class="o">,</span> <span class="k">new</span> <span class="n">Individu</span><span class="o">.</span><span class="na">Comparateur</span><span class="o">());</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">individus</span><span class="o">));</span>
</pre></div>
</div>
<p>Dans l’exemple ci-dessus, la classe <em>Individu</em> fournit publiquement une
implémentation d’un <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html">Comparator</a> qui permet de comparer deux instances en
fonction de leur nom et de leur prénom. Notez que l’implémentation de la
méthode <em>compare</em> peut accéder aux attributs privés <em>nom</em> et <em>prenom</em> des
paramètres <em>i1</em> et <em>i2</em> car ils sont de type <em>Individu</em>.</p>
</div>
<div class="section" id="id1">
<h2>Les classes internes<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une classe interne qui n’est pas déclarée avec le mot-clé
<strong>static</strong> est liée au contexte d’exécution d’une instance de la classe
englobante.</p>
<p>Comme pour les classes internes <strong>static</strong>, le nom complet de classe interne
inclus celui de la classe englobante et les deux classes partagent le même
espace privé. Mais surtout, une classe interne maintient une référence implicite
sur un objet de la classe englobante. Cela signifie que :</p>
<ul class="simple">
<li>une instance d’une classe interne ne peut être créée que par un objet de
classe englobante : c’est-à-dire dans le corps d’une méthode ou dans le corps
d’un constructeur de la classe englobante.</li>
<li>une instance d’une classe interne a accès directement aux attributs de l’instance
dans le contexte de laquelle elle a été créée.</li>
</ul>
<p>Une classe interne est utilisée pour créer un objet qui a couplage très
fort avec un objet du type de la classe englobante. On utilise fréquemment le
mécanisme de classe interne lorsque l’on veut réaliser une interface graphique
en Java avec l’API <a class="reference external" href="https://docs.oracle.com/javase/tutorial/uiswing/index.html">Swing</a>.</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.awt.FlowLayout</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.event.ActionEvent</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.swing.AbstractAction</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JButton</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JDialog</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JLabel</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoiteDeDialogue</span> <span class="kd">extends</span> <span class="n">JDialog</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">class</span> <span class="nc">IncrementerAction</span> <span class="kd">extends</span> <span class="n">AbstractAction</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">IncrementerAction</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">super</span><span class="o">(</span><span class="s">&quot;Incrémenter&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">incrementer</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kd">class</span> <span class="nc">DecrementerAction</span> <span class="kd">extends</span> <span class="n">AbstractAction</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">DecrementerAction</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">super</span><span class="o">(</span><span class="s">&quot;Décrémenter&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">decrementer</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="n">JLabel</span> <span class="n">label</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">valeur</span><span class="o">;</span>

  <span class="nd">@Override</span>
  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">dialogInit</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">dialogInit</span><span class="o">();</span>
    <span class="k">this</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">());</span>
    <span class="k">this</span><span class="o">.</span><span class="na">label</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">valeur</span><span class="o">));</span>
    <span class="k">this</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">label</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="k">new</span> <span class="n">IncrementerAction</span><span class="o">()));</span>
    <span class="k">this</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="k">new</span> <span class="n">DecrementerAction</span><span class="o">()));</span>
    <span class="k">this</span><span class="o">.</span><span class="na">pack</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">incrementer</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">label</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(++</span><span class="k">this</span><span class="o">.</span><span class="na">valeur</span><span class="o">));</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">decrementer</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">label</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(--</span><span class="k">this</span><span class="o">.</span><span class="na">valeur</span><span class="o">));</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">BoiteDeDialogue</span> <span class="n">boiteDeDialogue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BoiteDeDialogue</span><span class="o">();</span>
    <span class="n">boiteDeDialogue</span><span class="o">.</span><span class="na">setDefaultCloseOperation</span><span class="o">(</span><span class="n">DISPOSE_ON_CLOSE</span><span class="o">);</span>
    <span class="n">boiteDeDialogue</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>L’exemple ci-dessus est un programme complet qui crée une boite de dialogue
contenant deux boutons qui permettent respectivement d’incrémenter et de
décrémenter un nombre qui est affiché. La classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/javax/swing/JButton.html">JButton</a> qui représente un
bouton attend comme paramètre de construction une instance
implémentant l’interface <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/javax/swing/Action.html">Action</a>. Cette instance définit le libellé du bouton et l’action
à réaliser lorsque l’utilisateur clique sur le bouton. Les boutons sont créés
aux lignes 44 et 45. Les classes d’action utilisées pour chaque bouton sont
définies aux lignes 13 et 24. Ces classes sont
des classes internes. Dans leur méthode <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/javax/swing/Action.html">actionPerformed</a>, elles appellent soit
la méthode <em>incrementer</em> soit la méthode <em>decrementer</em>. Ces deux méthodes
sont définies par la classe englobante BoiteDeDialogue. Donc les instances de
ces classes d’action appellent ces méthodes sur l’instance de l’objet englobant
qui les a créées. Ainsi, les classes internes
possèdent une référence sur l’objet BoiteDeDialogue qui les a créées.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Notez dans l’exemple ci-dessus que les méthodes <em>BoiteDeDialogue.incrementer</em>
et <em>BoiteDeDialogue.decrementer</em> sont privées. Comme une classe interne
partage la même portée que sa classe englobante alors les classes internes
<em>IncrementerAction</em> et <em>DecrementerAction</em> peuvent appeler ces méthodes.</p>
</div>
</div>
<div class="section" id="les-classes-anonymes">
<h2>Les classes anonymes<a class="headerlink" href="#les-classes-anonymes" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une classe anonyme est une classe qui n’a pas de nom. Elle est déclarée au moment
de l’instanciation d’un objet. Comme une classe anonyme n’a pas de nom, il n’est
pas possible de déclarer une variable qui serait un type de cette classe. Une
classe anonyme est donc utilisée pour créer à la volée une classe qui spécialise
une autre classe ou qui implémente une interface. Pour déclarer une classe anonyme,
on déclare le bloc de la classe au moment de l’instantiation avec <strong>new</strong>.</p>
<p>Imaginons que nous souhaitions créer une interface pour représenter un système
de log :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3.logger</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Logger</span> <span class="o">{</span>

  <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">);</span>

<span class="o">}</span>
</pre></div>
</div>
<p>On peut fournir une classe <em>GenerateurLogger</em> qui crée des instances implémentant
l’interface <em>Logger</em>.</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3.logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenerateurLogger</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">application</span><span class="o">;</span>

  <span class="cm">/**</span>
<span class="cm">   * @param application Le nom de l&#39;application</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="nf">GenerateurLogger</span><span class="o">(</span><span class="n">String</span> <span class="n">application</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">application</span> <span class="o">=</span> <span class="n">application</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerConsoleLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Pour le format du message utilisé dans printf</span>
        <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%1$tY-%1$tb-%1$ta %1$tH:%1$tM %2$s - %3$s&quot;</span><span class="o">,</span>
                                         <span class="n">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">application</span><span class="o">,</span> <span class="n">message</span><span class="o">));</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>L’implémentation de la méthode <em>creerConsoleLogger</em> crée une instance
implémentant l’interface <em>Logger</em> à partir d’une classe anonyme. L’implémentation
de la méthode <em>log</em> affiche sur la sortie standard une chaîne de caractères
formatée contenant la date et l’heure, le nom de l’application et le message
passé en paramètre. Le nom de l’application correspond à l’attribut <em>application</em>
de la classe <em>GenerateurLogger</em>. Comme pour les classes internes, les classes
anonymes ont accès aux attributs et aux méthodes de l’objet englobant.</p>
<p>Il est possible de récupérer un objet implémetant <em>Logger</em> :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">GenerateurLogger</span> <span class="n">generateur</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GenerateurLogger</span><span class="o">(</span><span class="s">&quot;mon_appli&quot;</span><span class="o">);</span>
<span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">generateur</span><span class="o">.</span><span class="na">creerConsoleLogger</span><span class="o">();</span>
<span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">&quot;un message de log&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>Le code précédent affichera sur la sortie standard :</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>2017-nov.-jeu. 15:58 mon_appli - un message de log
</pre></div>
</div>
<p>Nous pouvons enrichir notre implémentation. Par exemple, la classe <em>GenerateurLogger</em>
peut créer un logger qui ne fait rien ou encore un logger qui écrit les messages
dans un fichier.</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3.logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.Writer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.StandardOpenOption</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenerateurLogger</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">application</span><span class="o">;</span>

  <span class="cm">/**</span>
<span class="cm">   * @param application Le nom de l&#39;application</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="nf">GenerateurLogger</span><span class="o">(</span><span class="n">String</span> <span class="n">application</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">application</span> <span class="o">=</span> <span class="n">application</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerConsoleLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Pour le format du message utilisé dans printf</span>
        <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%1$tY-%1$tb-%1$ta %1$tH:%1$tM %2$s - %3$s&quot;</span><span class="o">,</span>
                                         <span class="n">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">application</span><span class="o">,</span> <span class="n">message</span><span class="o">));</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerNoopLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerFileLogger</span><span class="o">(</span><span class="n">Path</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Pour le format du message utilisé dans printf</span>
        <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>
        <span class="n">String</span> <span class="n">logMessage</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%1$tY-%1$tb-%1$ta %1$tH:%1$tM %2$s - %3$s&quot;</span><span class="o">,</span>
                                          <span class="n">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">application</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
        <span class="k">try</span><span class="o">(</span><span class="n">Writer</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="na">newBufferedWriter</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">CREATE</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">APPEND</span><span class="o">))</span> <span class="o">{</span>
          <span class="n">w</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">logMessage</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="sc">&#39;\n&#39;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">logMessage</span><span class="o">);</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>La classe ci-dessus définit maintenant trois classes anonymes qui implémentent toutes
l’interface <em>Logger</em>. Notez à la ligne 50, que la classe anonyme qui écrit le
message de log dans un fichier, ouvre le fichier à partir d’un paramètre <em>path</em>
passé à la méthode <em>creerFileLogger</em>. Cela signifie qu’une classe anonyme
a accès au paramètre de la méthode qui la déclare.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Une classe anonyme peut utiliser les paramètres et les variables de la méthode qui la déclare
uniquement à condition qu’ils ne soient modifiés ni par la méthode ni par la
classe anonyme. Avant Java 8, le compilateur exigeait que ces
paramètres et ces variables soient déclarés avec le mot-clé <strong>final</strong>. Même
s’il n’est plus nécessaire de déclarer explicitement le statut <strong>final</strong>,
le compilateur générera tout de même une erreur si on tente de modifier un
paramètre ou une variable déclaré dans la méthode et utilisé par une classe anonyme.</p>
<div class="last highlight-java"><div class="highlight"><pre><span></span><span class="c1">// on déclare le paramètre final pour signaler explicitement qu&#39;il n&#39;est</span>
<span class="c1">// pas possible de modifier la référence de ce paramètre puisqu&#39;il est</span>
<span class="c1">// utilisé par la classe anonyme.</span>
<span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerFileLogger</span><span class="o">(</span><span class="kd">final</span> <span class="n">Path</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Pour le format du message utilisé dans printf</span>
      <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>
      <span class="n">String</span> <span class="n">logMessage</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%1$tY-%1$tb-%1$ta %1$tH:%1$tM %2$s - %3$s&quot;</span><span class="o">,</span>
                                        <span class="n">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">application</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
      <span class="k">try</span><span class="o">(</span><span class="n">Writer</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="na">newBufferedWriter</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">CREATE</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">APPEND</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">w</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">logMessage</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="sc">&#39;\n&#39;</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">logMessage</span><span class="o">);</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">};</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="acces-aux-elements-de-l-objet-englobant">
<h2>Accès aux éléments de l’objet englobant<a class="headerlink" href="#acces-aux-elements-de-l-objet-englobant" title="Lien permanent vers ce titre">¶</a></h2>
<p>Si nous reprenons notre code de la classe <em>GenerateurLogger</em>, nous nous
rendons compte que le formatage du message a été dupliqué pour le logger
qui écrit sur la sortie standard et pour celui qui écrit dans un fichier. Afin
de mutualiser le code, nous pouvons créer une méthode <em>genererLogMessage</em>
dans la classe englobante qui pourra être appelée par chaque classe anonyme.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3.logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.Writer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.StandardOpenOption</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenerateurLogger</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">application</span><span class="o">;</span>

  <span class="cm">/**</span>
<span class="cm">   * @param application Le nom de l&#39;application</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="nf">GenerateurLogger</span><span class="o">(</span><span class="n">String</span> <span class="n">application</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">application</span> <span class="o">=</span> <span class="n">application</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerConsoleLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Pour le format du message utilisé dans printf</span>
        <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">genererLogMessage</span><span class="o">(</span><span class="n">message</span><span class="o">));</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerFileLogger</span><span class="o">(</span><span class="n">Path</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span><span class="o">(</span><span class="n">Writer</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="na">newBufferedWriter</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">CREATE</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">APPEND</span><span class="o">))</span> <span class="o">{</span>
          <span class="n">w</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">genererLogMessage</span><span class="o">(</span><span class="n">message</span><span class="o">)).</span><span class="na">append</span><span class="o">(</span><span class="sc">&#39;\n&#39;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">genererLogMessage</span><span class="o">(</span><span class="n">message</span><span class="o">));</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerNoopLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="nf">genererLogMessage</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%1$tY-%1$tb-%1$ta %1$tH:%1$tM %2$s - %3$s&quot;</span><span class="o">,</span>
                         <span class="n">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">application</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<p>Mais nous voulons appeler cette nouvelle méthode <em>log</em>. Ce nom rentrera
en collision avec le nom de le méthode <em>log</em> de l’interface <em>Logger</em>.
Il existe une syntaxe particulière qui permet de référencer explicitement
le contexte de la classe englobante en utilisant :</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>NomDeLaClasse.this
</pre></div>
</div>
<p>Ainsi nous pouvons renommer notre méthode <em>genererLogMessage</em> en <em>log</em>
et nous pouvons l’invoquer explicitement dans les méthodes des classes anonymes avec la
syntaxe :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">GenerateurLogger</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cette syntaxe permet d’accéder aux attributs et aux méthodes de l’instance de
la classe englobante.</p>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3.logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.Writer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.StandardOpenOption</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenerateurLogger</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">application</span><span class="o">;</span>

  <span class="cm">/**</span>
<span class="cm">   * @param application Le nom de l&#39;application</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="nf">GenerateurLogger</span><span class="o">(</span><span class="n">String</span> <span class="n">application</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">application</span> <span class="o">=</span> <span class="n">application</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerConsoleLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Pour le format du message utilisé dans printf</span>
        <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">GenerateurLogger</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">message</span><span class="o">));</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerFileLogger</span><span class="o">(</span><span class="n">Path</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Pour le format du message utilisé dans printf</span>
        <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>
        <span class="k">try</span><span class="o">(</span><span class="n">Writer</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="na">newBufferedWriter</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">CREATE</span><span class="o">,</span> <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">APPEND</span><span class="o">))</span> <span class="o">{</span>
          <span class="n">w</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">GenerateurLogger</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">message</span><span class="o">)).</span><span class="na">append</span><span class="o">(</span><span class="sc">&#39;\n&#39;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">GenerateurLogger</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">message</span><span class="o">));</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerNoopLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Logger</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%1$tY-%1$tb-%1$ta %1$tH:%1$tM %2$s - %3$s&quot;</span><span class="o">,</span>
                         <span class="n">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">application</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Il n’est pas possible de déclarer un constructeur dans une classe anonyme. En
effet, un constructeur porte le même nom que sa classe et justement, par
définition, les classes anonymes n’ont pas de nom. Le compilateur générera
néanmoins un constructeur par défaut.</p>
<p class="last">Cela entraîne une limitation : il n’est pas possible de déclarer une classe anonyme
qui étendrait une classe ne possédant pas de constructeur sans paramètre.</p>
</div>
</div>
<div class="section" id="classe-interne-a-une-methode">
<h2>Classe interne à une méthode<a class="headerlink" href="#classe-interne-a-une-methode" title="Lien permanent vers ce titre">¶</a></h2>
<p>Il est possible de déclarer une classe dans une méthode. Dans ce cas, il n’est
pas possible de préciser la portée de la classe. La classe a automatiquement
une portée très particulière puisqu’elle n’est visible que depuis la méthode
dans laquelle elle est déclarée. Une classe déclarée dans une
méthode peut fonctionner de la même manière qu’une classe anonyme : elle
peut accéder aux paramètres et aux variables de la méthode qui la déclare (à
condition qu’ils ne soient modifiés ni par la méthode ni par la classe).</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3.logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenerateurLogger</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">application</span><span class="o">;</span>

  <span class="cm">/**</span>
<span class="cm">   * @param application Le nom de l&#39;application</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="nf">GenerateurLogger</span><span class="o">(</span><span class="n">String</span> <span class="n">application</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">application</span> <span class="o">=</span> <span class="n">application</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Logger</span> <span class="nf">creerConsoleLogger</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">class</span> <span class="nc">ConsoleLogger</span> <span class="kd">implements</span> <span class="n">Logger</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Pour le format du message utilisé dans printf</span>
        <span class="c1">// Cf. https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html#syntax</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">GenerateurLogger</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">message</span><span class="o">));</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">ConsoleLogger</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="nf">log</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%1$tY-%1$tb-%1$ta %1$tH:%1$tM %2$s - %3$s&quot;</span><span class="o">,</span>
                         <span class="n">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">application</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<p>Dans l’exemple ci-dessus, la méthode <em>creerConsoleLogger</em> déclare la classe
interne <em>ConsoleLogger</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Contrairement aux classes anonymes, une classe interne à une méthode peut
déclarer des constructeurs.</p>
</div>
</div>
<div class="section" id="interface-et-enumeration">
<h2>Interface et énumération<a class="headerlink" href="#interface-et-enumeration" title="Lien permanent vers ce titre">¶</a></h2>
<p>Il est possible de déclarer des interfaces et des énumérations dans une classe.
Il est même possible de déclarer des interfaces et des énumérations dans une
interface. Dans ce cas, les interfaces et les énumérations sont traitées
implicitement comme <strong>static</strong>. On peut ou non préciser le mot-clé.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">fr.epsi.b3</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClasseEnglobante</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">InterfaceInterne</span> <span class="o">{</span>

  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">enum</span> <span class="n">EnumerationInterne</span><span class="o">{</span><span class="n">VALEUR1</span><span class="o">,</span> <span class="n">VALEUR2</span><span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="plusieurs-classes-dans-un-meme-fichier">
<h2>Plusieurs classes dans un même fichier<a class="headerlink" href="#plusieurs-classes-dans-un-meme-fichier" title="Lien permanent vers ce titre">¶</a></h2>
<p>Même s’il ne s’agit pas de classes internes, il est possible de déclarer
plusieurs classes dans un même fichier en Java. Mais les classes supplémentaires
sont forcément de portée package.</p>
<p>En pratique cette possibilité n’est jamais utilisée par les développeurs qui
préfèrent utiliser des classes internes <strong>static</strong> ou un fichier propre à
chaque classe.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Le langage Java</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">Compilation &amp; exécution</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_fondamentale.html">La structure fondamentale du langage</a></li>
<li class="toctree-l1"><a class="reference internal" href="premiere_classe.html">Une première classe</a></li>
<li class="toctree-l1"><a class="reference internal" href="types_primitifs.html">Les types primitifs</a></li>
<li class="toctree-l1"><a class="reference internal" href="operateurs.html">Les opérateurs</a></li>
<li class="toctree-l1"><a class="reference internal" href="structures_de_controle.html">Les structures de contrôle</a></li>
<li class="toctree-l1"><a class="reference internal" href="tableau.html">Les tableaux</a></li>
<li class="toctree-l1"><a class="reference internal" href="attributs_et_methodes.html">Attributs &amp; méthodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="cycle_de_vie.html">Cycle de vie d’un objet</a></li>
<li class="toctree-l1"><a class="reference internal" href="package.html">Les packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="relations_entre_objets.html">Les relations entre objets</a></li>
<li class="toctree-l1"><a class="reference internal" href="polymorphisme.html">Le polymorphisme</a></li>
<li class="toctree-l1"><a class="reference internal" href="la_classe_object.html">La classe Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="la_classe_string.html">La classe String</a></li>
<li class="toctree-l1"><a class="reference internal" href="les_exceptions.html">Les exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="classe_abstraite.html">Les classes abstraites</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumeration.html">Les énumérations</a></li>
<li class="toctree-l1"><a class="reference internal" href="les_dates.html">Les dates</a></li>
<li class="toctree-l1"><a class="reference internal" href="generiques.html">Méthodes et classes génériques</a></li>
<li class="toctree-l1"><a class="reference internal" href="les_collections.html">Les collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Les interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="entrees_sorties.html">Les entrées/sorties</a></li>
<li class="toctree-l1"><a class="reference internal" href="les_lambdas.html">Les lambdas</a></li>
<li class="toctree-l1"><a class="reference internal" href="streams.html">Streams</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Les classes internes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#les-classes-internes-static">Les classes internes static</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Les classes internes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#les-classes-anonymes">Les classes anonymes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#acces-aux-elements-de-l-objet-englobant">Accès aux éléments de l’objet englobant</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classe-interne-a-une-methode">Classe interne à une méthode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interface-et-enumeration">Interface et énumération</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plusieurs-classes-dans-un-meme-fichier">Plusieurs classes dans un même fichier</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="les_annotations.html">Les annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="swing_interfaces_graphiques.html">Swing : les interfaces graphiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="swing_interactions.html">Swing : les interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="swing_notions_avancees.html">Swing : notions avancées</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://docs.oracle.com/javase/8/docs/">Documentation Java</a></li>
    
    <li class="toctree-l1"><a href="http://docs.oracle.com/javase/8/docs/api/index.html?overview-summary.html">API Java</a></li>
    
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;
<a ref="author" href="mailto:david.gayerie.epsi@mailoo.org">David Gayerie</a>
<a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/fr/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/fr/80x15.png" /></a>
.
      
    </div>

    

    
  </body>
</html>